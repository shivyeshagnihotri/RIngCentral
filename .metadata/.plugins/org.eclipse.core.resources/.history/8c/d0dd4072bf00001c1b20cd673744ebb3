package group.artifact;

import java.io.FileInputStream;
import java.util.Properties;

import org.json.JSONObject;
import org.testng.annotations.BeforeTest;
import org.testng.annotations.Test;
import org.testng.asserts.SoftAssert;

import io.restassured.RestAssured;
import io.restassured.http.Method;
import io.restassured.response.Response;
import io.restassured.specification.RequestSpecification;

public class ApiTestcases {

	Properties prop;
	SoftAssert asserts;

	@BeforeTest
	public void config() throws Exception{
		prop = new Properties();
		FileInputStream fis = new FileInputStream("config.properties");
		prop.load(fis); 

	}

	//GET request with invalid id
	@Test(priority=1)
	public void getInvalidId() throws Exception
	{
		asserts = new SoftAssert();
		RestAssured.baseURI = "http://localhost:8080";
		RequestSpecification getIdRequest = RestAssured.given();
		Response getById = getIdRequest.request(Method.GET,"/api/users/"+prop.getProperty("invalidId"));
		//System.out.println(getById.asString());
		//System.out.println(getById.statusCode());
		asserts.assertEquals(getById.statusCode(),404);
		asserts.assertAll();
	}

	//GET request where id is not of type int
	@Test(priority=2)
	public void getStringid() throws Exception
	{
		asserts = new SoftAssert();
		RestAssured.baseURI = "http://localhost:8080";
		RequestSpecification getIdRequest = RestAssured.given();
		Response getById = getIdRequest.request(Method.GET,"/api/users/hello");
		//System.out.println(getById.asString());
		//System.out.println(getById.statusCode());
		asserts.assertEquals(getById.statusCode(),400);
		asserts.assertAll();
	}

	@Test(priority=2)
	public void getNullid() throws Exception
	{
		asserts = new SoftAssert();
		RestAssured.baseURI = "http://localhost:8080";
		RequestSpecification getIdRequest = RestAssured.given();
		Response getById = getIdRequest.request(Method.GET,"/api/users/hello");
		//System.out.println(getById.asString());
		System.out.println(getById.statusCode());
		asserts.assertEquals(getById.statusCode(),400);
		asserts.assertAll();
	}
	
	//PUT request for invalid id
	@Test(priority=3)
	public void invalidPutById() throws Exception
	{
		RestAssured.baseURI = "http://localhost:8080";
		RequestSpecification getIdRequest = RestAssured.given();
		Response getById = getIdRequest.request(Method.GET,"/api/users/"+prop.getProperty("invalidId"));
	}

	@Test(priority=4)
	public void validGetById() throws Exception
	{
		RestAssured.baseURI = "http://localhost:8080";
		RequestSpecification getIdRequest = RestAssured.given();
		Response getById = getIdRequest.request(Method.GET,"/api/users/"+prop.getProperty("validId"));
		System.out.println(getById.asString());
		//JSONObject byIdPath = new JSONObject(getById.asString());
		//System.out.println(getById.getHeaders());
		//System.out.println(byIdPath.get("firstName"));

	}


}
